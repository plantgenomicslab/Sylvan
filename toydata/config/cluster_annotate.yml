################################################################################
#                           SLURM CLUSTER CONFIGURATION
#                    Sylvan Genome Annotation Pipeline
################################################################################

#===============================================================================
# DEFAULT SETTINGS
#===============================================================================
__default__:
  account: cpu-s1-pgl-0                  # SLURM account
  partition: cpu-s1-pgl-0                # SLURM partition
  memory: 4g
  name: "{rule}.{wildcards}"
  ncpus: 1
  nodes: 1
  time: 14-00:00:00
  output: results/logs/{rule}_{wildcards}.out
  error: results/logs/{rule}_{wildcards}.err

################################################################################
#                           ANNOTATE PHASE
################################################################################

#===============================================================================
# Genome Preparation
#===============================================================================
prepareGenome:
  ncpus: 1
  memory: 4g
genomeSplitJoin:
  ncpus: 2
  memory: 8g

#===============================================================================
# Repeat Masking (GETA)
#===============================================================================
RepeatMasker_species:
  ncpus: 64
  threads: 64
  memory: 220g
RepeatModeler:
  ncpus: 64
  threads: 64
  memory: 220g
RepeatMasker_custom:
  ncpus: 64
  threads: 64
  memory: 220g
RepeatMasker_merge:
  ncpus: 64
  threads: 64
  memory: 220g

#===============================================================================
# RNA-seq Quality Control (GETA)
#===============================================================================
fastp_PAIRED:
  ncpus: 8
  threads: 8
  memory: 32g
fastp_SINGLE:
  ncpus: 8
  threads: 8
  memory: 32g

#===============================================================================
# RNA-seq Alignment - HiSat2 (GETA)
#===============================================================================
HiSat2_build:
  ncpus: 4
  memory: 16g
HiSat2_PAIRED:
  ncpus: 16
  threads: 16
  memory: 64g
HiSat2_SINGLE:
  ncpus: 16
  threads: 16
  memory: 64g
mergeHiSat:
  ncpus: 48
  threads: 48
  memory: 192g
  sortthreads: 8
  sortmem: 16G
HiSat2_split:
  ncpus: 48
  threads: 48
  memory: 192g
addXS:
  ncpus: 12
  memory: 48g

#===============================================================================
# RNA-seq Alignment - STAR (GETA)
#===============================================================================
STAR_generate:
  ncpus: 12
  threads: 12
  memory: 48g
STAR_paired:
  ncpus: 48
  threads: 48
  memory: 192g
STAR_single:
  ncpus: 48
  threads: 48
  memory: 192g
mergeSTAR:
  ncpus: 12
  threads: 12
  memory: 48g
  sortthreads: 8
  sortmem: 16G
STAR_split:
  ncpus: 4
  threads: 4
  memory: 16g

#===============================================================================
# Transcript Assembly (GETA)
#===============================================================================
psiClass_HiSat:
  ncpus: 16
  threads: 16
  memory: 64g
stringtie_HiSat:
  ncpus: 32
  threads: 32
  memory: 128g
psiClass_STAR:
  ncpus: 48
  threads: 48
  memory: 192g
stringtie_STAR:
  ncpus: 32
  threads: 32
  memory: 128g
Sam2Transfrag:
  ncpus: 4
  memory: 16g
mergeTransfrag:
  ncpus: 4
  memory: 16g

#===============================================================================
# TransDecoder - ORF Prediction (GETA)
#===============================================================================
transDecoder_LongOrfs:
  ncpus: 4
  memory: 16g
transDecoder_Predict:
  ncpus: 4
  memory: 16g
transdecoder2ORF:
  ncpus: 4
  memory: 16g
GFF3Clear:
  ncpus: 4
  memory: 16g
transfragComplete:
  ncpus: 4
  memory: 16g

#===============================================================================
# Homolog Alignment - Miniprot/Genewise (GETA)
#===============================================================================
mergeProteins:
  ncpus: 4
  threads: 4
  memory: 16g
splitProteins:
  ncpus: 4
  threads: 4
  memory: 16g
miniprot:
  ncpus: 48
  threads: 48
  memory: 192g
miniprot2genewise:
  ncpus: 1
  memory: 4g
merge_geneRegion2Genewise:
  ncpus: 1
  memory: 4g
geneRegion2Genewise:
  ncpus: 2
  threads: 2
  memory: 8g
genewiseGFF2GFF3:
  ncpus: 4
  memory: 16g

#===============================================================================
# Gene Model Combination - Step 1 (GETA)
#===============================================================================
combineGeneModelsPlus:
  ncpus: 4
  memory: 16g
combineGeneModelsMinus:
  ncpus: 4
  memory: 16g
aggregate_CombineGeneModels:
  ncpus: 4
  memory: 16g
clearCombined:
  ncpus: 4
  memory: 16g
ORF2bestGeneModels:
  ncpus: 4
  memory: 16g
bestGeneModels2lowIdentity:
  ncpus: 4
  threads: 4
  memory: 16g

#===============================================================================
# Augustus Training & Prediction (GETA)
#===============================================================================
geneModels2AugusutsTrainingInput:
  ncpus: 4
  threads: 4
  memory: 16g
BGM2AT:
  ncpus: 12
  threads: 12
  memory: 220g
prepareAugusutusHints:
  ncpus: 4
  memory: 16g
augustusWithHints:
  ncpus: 4
  memory: 16g
combineAugustusWithHints:
  ncpus: 4
  memory: 16g

#===============================================================================
# Gene Model Combination - Step 2 (GETA)
#===============================================================================
combineGeneModelsPlus_step6:
  ncpus: 4
  memory: 16g
combineGeneModelsMinus_step6:
  ncpus: 4
  memory: 16g
aggregate_CombineGeneModels_step6:
  ncpus: 4
  memory: 16g
clearCombined_step6:
  ncpus: 4
  memory: 16g
pickBetterModels:
  ncpus: 4
  memory: 16g

#===============================================================================
# Gene Model Filling & Alternative Splicing (GETA)
#===============================================================================
fillingEndsOfGeneModels_ef:
  ncpus: 4
  memory: 16g
AS_gb:
  ncpus: 4
  memory: 16g
aggregateAS_gb:
  ncpus: 4
  memory: 16g
AS_ge:
  ncpus: 4
  memory: 16g
aggregateAS_ge:
  ncpus: 4
  memory: 16g
AS_gf:
  ncpus: 4
  memory: 16g
aggregateAS_gf:
  ncpus: 4
  memory: 16g

#===============================================================================
# Gene Model Filtering (GETA)
#===============================================================================
extractTranscriptsForFilter:
  ncpus: 4
  memory: 16g
splitFilterProteins:
  ncpus: 4
  memory: 16g
filterHMMScan:
  ncpus: 4
  threads: 4
  memory: 16g
combineHMMScan:
  ncpus: 4
  memory: 16g
makeFilterBlastDB:
  ncpus: 4
  threads: 4
  memory: 16g
filterBlastP:
  ncpus: 4
  threads: 4
  memory: 16g
parseBlastResult:
  ncpus: 4
  memory: 16g
validateTranscripts:
  ncpus: 4
  memory: 16g
fillingEndsOfGeneModels_final:
  ncpus: 4
  memory: 16g
GETA_output:
  ncpus: 4
  memory: 16g

#===============================================================================
# Ab Initio Prediction - Helixer
#===============================================================================
helixer:
  #account: placeholder                # SLURM gpu account
  #partition: placeholder              # SLURM gpu parition
  ncpus: 12
  threads: 12
  memory: 48g

#===============================================================================
# Liftover - LiftOff & GMAP
#===============================================================================
liftoff:
  ncpus: 24
  threads: 24
  memory: 96g
gmapPrep:
  ncpus: 4
  memory: 16g
gmapExon:
  ncpus: 16
  threads: 16
  memory: 64g

#===============================================================================
# Transcript Assembly from Reads - SPAdes & Evigene
#===============================================================================
bamToFastq:
  ncpus: 12
  threads: 12
  memory: 48g
bam2Fasta:
  ncpus: 32
  threads: 32
  memory: 124g
spades:
  ncpus: 48
  threads: 48
  memory: 192g
evigene:
  ncpus: 12
  threads: 12
  memory: 48g

#===============================================================================
# PASA - Transcript Alignment & Assembly
#===============================================================================
pasaPrep:
  ncpus: 4
  memory: 16g
pasa:
  ncpus: 64
  threads: 64
  memory: 216g

#===============================================================================
# EVM - Evidence Modeler
#===============================================================================
convertToEvmFormat:
  ncpus: 1
  memory: 4g
combineEVMInputs:
  ncpus: 1
  memory: 4g
partitionEVM:
  ncpus: 12
  memory: 48g
writeEVMCommands:
  ncpus: 4
  memory: 16g
runEVM:
  ncpus: 1
  memory: "{resources.mem_mb}M"
recombineEVM:
  ncpus: 4
  memory: 16g

#===============================================================================
# Post-EVM - PASA Update
#===============================================================================
pasaPost:
  ncpus: 48
  threads: 48
  memory: 192g

################################################################################
#                           FILTER PHASE
################################################################################

#===============================================================================
# Portcullis - Junction Filtering
#===============================================================================
portcullis:
  ncpus: 12
  threads: 12
  memory: 48g

#===============================================================================
# Mikado - Transcript Selection
#===============================================================================
mikadoConfigure:
  ncpus: 1
  memory: 4g
mikadoPrepare:
  ncpus: 1
  memory: 4g
mikadoMakeDB:
  ncpus: 1
  memory: 4g
mikadoBlastX:
  ncpus: 16
  threads: 16
  memory: 64g
mikadoTransdecoder_LongOrfs:
  ncpus: 4
  threads: 4
  memory: 16g
mikadoTransdecoder_Predict:
  ncpus: 4
  threads: 4
  memory: 16g
mikadoSerialise:
  ncpus: 4
  memory: 16g
mikadoPick:
  ncpus: 4
  memory: 16g

#===============================================================================
# Evidence-Based Combination
#===============================================================================
EvidentialCombine:
  ncpus: 16
  memory: 64g
